"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[805],{9174:function(e,t,n){n.d(t,{Ct:function(){return r},K6:function(){return c}});var a=n(7437),i=n(3448);let s={default:"bg-charcoal-700 text-charcoal-300",critical:"bg-status-critical-bg text-status-critical",high:"bg-status-high-bg text-status-high",medium:"bg-status-medium-bg text-status-medium",low:"bg-charcoal-700 text-charcoal-400",info:"bg-status-info-bg text-status-info",success:"bg-status-success-bg text-status-success",outline:"border border-charcoal-600 text-charcoal-300 bg-transparent"};function r(e){let{className:t,variant:n="default",...r}=e;return(0,a.jsx)("span",{className:(0,i.cn)("inline-flex items-center rounded px-2 py-0.5 text-xs font-semibold uppercase tracking-wide","outline"===n?"py-[1px]":"",s[n],t),...r})}function c(e){let{engine:t,icon:n,className:s,...r}=e;return(0,a.jsxs)("span",{className:(0,i.cn)("inline-flex items-center gap-1.5 rounded bg-bronze-600/15 px-2 py-0.5 text-xs text-bronze-400 border border-bronze-600/30",s),...r,children:[n&&(0,a.jsx)("span",{className:"font-serif",children:n}),t]})}},9820:function(e,t,n){n.d(t,{Zb:function(){return s}});var a=n(7437),i=n(3448);function s(e){let{className:t,accent:n,children:s,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)("rounded-lg border bg-bg-secondary",n?"border-bronze-600/40":"border-charcoal-600/30",t),...r,children:s})}},8210:function(e,t,n){n.d(t,{sg:function(){return l},x3:function(){return y},XF:function(){return f},_C:function(){return m},TO:function(){return g}});var a=n(1713),i=n(9827),s=n(1770),r=n(2243);async function c(){let e=await n.e(519).then(n.bind(n,6519));return{getCases:async()=>e.getCases(),getCase:async t=>e.getCase(t),createCase:async t=>e.createCase(t),deleteCase:async t=>e.deleteCase(t),getDocuments:async t=>e.getDocuments(t),getDocument:async t=>e.getDocument(t),uploadDocument:async t=>e.uploadDocument(t.caseId,t.file,t.docType),deleteDocument:async t=>e.deleteDocument(t),getEntities:async e=>(console.log("[Tauri] getEntities not yet implemented",e),[]),getFindings:async(t,n)=>e.getFindings(t),getClaims:async e=>(console.log("[Tauri] getClaims not yet implemented",e),[]),getContradictions:async t=>(await e.getAnalysis(t)).contradictions,getAnalysis:async t=>e.getAnalysis(t),async runEngine(t){let n=await e.runEngine({case_id:t.caseId,engine_id:t.engineId,document_ids:t.documentIds,options:t.options});return{success:n.success,engineId:n.engine_id,findings:n.findings,durationMs:n.duration_ms,error:n.error}}}}async function o(){let{createClient:e}=await Promise.all([n.e(259),n.e(933)]).then(n.bind(n,8933)),t=e();return{async getCases(){let{data:e,error:n}=await t.from("cases").select("*").order("created_at",{ascending:!1});if(n)throw n;return e},async getCase(e){let{data:n,error:a}=await t.from("cases").select("*").eq("id",e).single();return a?null:n},async createCase(e){let{data:n,error:a}=await t.from("cases").insert({reference:e.reference,name:e.name,case_type:e.case_type,description:e.description,status:"active"}).select().single();if(a)throw a;return n},async deleteCase(e){let{error:n}=await t.from("cases").delete().eq("id",e);if(n)throw n},async getDocuments(e){let{data:n,error:a}=await t.from("documents").select("*").eq("case_id",e).order("created_at",{ascending:!1});if(a)throw a;return n},async getDocument(e){let{data:n,error:a}=await t.from("documents").select("*").eq("id",e).single();return a?null:n},async uploadDocument(e){let t=new FormData;t.append("file",e.file),t.append("caseId",e.caseId),e.docType&&t.append("docType",e.docType);let n=await fetch("/api/documents/upload",{method:"POST",body:t});if(!n.ok)throw Error("Upload failed");return n.json()},async deleteDocument(e){let{error:n}=await t.from("documents").delete().eq("id",e);if(n)throw n},async getEntities(e){let{data:n,error:a}=await t.from("entities").select("*").eq("case_id",e).order("canonical_name");if(a)throw a;return n},async getFindings(e,n){let a=t.from("findings").select("*").eq("case_id",e).order("created_at",{ascending:!1});n&&(a=a.eq("engine",n));let{data:i,error:s}=await a;if(s)throw s;return i},async getClaims(e){let{data:n,error:a}=await t.from("claims").select("*").eq("case_id",e).order("created_at",{ascending:!1});if(a)throw a;return n},async getContradictions(e){let{data:n,error:a}=await t.from("contradictions").select("*").eq("case_id",e).order("created_at",{ascending:!1});if(a)throw a;return n},async getAnalysis(e){let n=t.from("findings").select("*").eq("case_id",e).order("created_at",{ascending:!1}),a=t.from("contradictions").select("*").eq("case_id",e).order("created_at",{ascending:!1}),[i,s]=await Promise.all([n,a]);return{findings:i.data||[],contradictions:s.data||[],omissions:[]}},async runEngine(e){let t=await fetch("/api/engines/".concat(e.engineId,"/run"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({caseId:e.caseId,documentIds:e.documentIds,options:e.options})});if(!t.ok)throw Error("Engine execution failed");return t.json()}}}let u=null;async function d(){return u||((0,r.nI)()?(console.log("[DataLayer] Using Tauri backend"),u=await c()):(console.log("[DataLayer] Using Supabase backend"),u=await o())),u}function l(e){return(0,a.a)({queryKey:["documents",e],queryFn:async()=>(await d()).getDocuments(e),enabled:!!e})}function g(){let e=(0,i.NL)();return(0,s.D)({mutationFn:async e=>{let{file:t,caseId:n,docType:a}=e;return(await d()).uploadDocument({caseId:n,file:t,docType:a})},onMutate:async t=>{await e.cancelQueries({queryKey:["documents",t.caseId]});let n=e.getQueryData(["documents",t.caseId]);if(n){let a={id:"temp-".concat(Date.now()),case_id:t.caseId,filename:t.file.name,file_type:t.file.type||"application/octet-stream",file_size:t.file.size,storage_path:"",hash_sha256:"",acquisition_date:new Date().toISOString(),doc_type:t.docType||null,source_entity:null,status:"pending",extracted_text:null,page_count:null,metadata:{},created_at:new Date().toISOString(),updated_at:new Date().toISOString()};e.setQueryData(["documents",t.caseId],[a,...n])}return{previousDocs:n}},onError:(t,n,a)=>{(null==a?void 0:a.previousDocs)&&e.setQueryData(["documents",n.caseId],a.previousDocs)},onSettled:(t,n,a)=>{e.invalidateQueries({queryKey:["documents",a.caseId]})}})}function f(){let e=(0,i.NL)();return(0,s.D)({mutationFn:async e=>{if((0,r.nI)())return console.log("[Desktop] Document processing initiated:",e),{success:!0,documentId:e};let t=await fetch("/api/documents/process",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({documentId:e})});if(!t.ok)throw Error("Processing failed");return t.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["documents"]})}})}function y(e,t){return(0,a.a)({queryKey:["findings",e,t],queryFn:async()=>(await d()).getFindings(e,t),enabled:!!e})}function m(){let e=(0,i.NL)();return(0,s.D)({mutationFn:async e=>{let{engineId:t,caseId:n,documentIds:a,options:i}=e;return(await d()).runEngine({caseId:n,engineId:t,documentIds:a,options:i})},onSuccess:(t,n)=>{e.invalidateQueries({queryKey:["findings",n.caseId]}),e.invalidateQueries({queryKey:["entities",n.caseId]}),e.invalidateQueries({queryKey:["contradictions",n.caseId]}),e.invalidateQueries({queryKey:["analysis",n.caseId]})},onError:e=>{console.error("[Engine Error]",e)}})}},3177:function(e,t,n){n.d(t,{Ur:function(){return r}});var a=n(3011),i=n(6885);let s={activeCase:null,documents:[],entities:[],findings:[],selectedDocumentId:null,selectedEntityId:null,activeEngine:null,severityFilter:[],searchQuery:""},r=(0,a.U)()((0,i.tJ)(e=>({...s,setActiveCase:t=>e({activeCase:t}),setDocuments:t=>e({documents:t}),addDocument:t=>e(e=>({documents:[...e.documents,t]})),updateDocument:(t,n)=>e(e=>({documents:e.documents.map(e=>e.id===t?{...e,...n}:e)})),setEntities:t=>e({entities:t}),addEntity:t=>e(e=>({entities:[...e.entities,t]})),setFindings:t=>e({findings:t}),addFinding:t=>e(e=>({findings:[...e.findings,t]})),setSelectedDocumentId:t=>e({selectedDocumentId:t}),setSelectedEntityId:t=>e({selectedEntityId:t}),setActiveEngine:t=>e({activeEngine:t}),setSeverityFilter:t=>e({severityFilter:t}),setSearchQuery:t=>e({searchQuery:t}),reset:()=>e(s)}),{name:"apatheia-case-store",partialize:e=>({activeCase:e.activeCase,activeEngine:e.activeEngine,severityFilter:e.severityFilter})}))},2243:function(e,t,n){n.d(t,{nI:function(){return a},tc:function(){return o},vV:function(){return c}});let a=()=>"__TAURI__"in window;async function i(){if(!a())return null;try{let{invoke:e}=await n.e(924).then(n.bind(n,924));return e}catch(e){return console.warn("Failed to load Tauri API"),null}}class s{async init(){this.initialized||(this.invoke=await i(),this.initialized=!0)}async call(e,t){if(await this.init(),!this.invoke)throw Error("Tauri API not available - running in browser mode");return this.invoke(e,t)}async getCases(){let e=await this.call("get_cases");if(!e.success)throw Error(e.error||"Failed to get cases");return e.data}async getCase(e){var t;return null!==(t=(await this.call("get_case",{caseId:e})).data)&&void 0!==t?t:null}async createCase(e){let t=await this.call("create_case",{input:e});if(!t.success||!t.data)throw Error(t.error||"Failed to create case");return t.data}async deleteCase(e){let t=await this.call("delete_case",{caseId:e});if(!t.success)throw Error(t.error||"Failed to delete case")}async getDocuments(e){let t=await this.call("get_documents",{caseId:e});if(!t.success)throw Error(t.error||"Failed to get documents");return t.data}async getDocument(e){var t;return null!==(t=(await this.call("get_document",{documentId:e})).data)&&void 0!==t?t:null}async uploadDocument(e){let t=await this.call("upload_document",{input:e});if(!t.success||!t.data)throw Error(t.error||"Failed to upload document");return t.data}async updateDocumentStatus(e,t,n){let a=await this.call("update_document_status",{documentId:e,status:t,extractedText:n});if(!a.success||!a.data)throw Error(a.error||"Failed to update document status");return a.data}async deleteDocument(e){let t=await this.call("delete_document",{documentId:e});if(!t.success)throw Error(t.error||"Failed to delete document")}async getFindings(e){let t=await this.call("get_findings",{caseId:e});if(!t.success)throw Error(t.error||"Failed to get findings");return t.data}async getAnalysis(e){let t=await this.call("get_analysis",{caseId:e});if(!t.success)throw Error(t.error||"Failed to get analysis");return{findings:t.findings,contradictions:t.contradictions,omissions:t.omissions}}async runEngine(e){let t=await this.call("run_engine",{input:e});if(!t.success)throw Error(t.error||"Failed to run engine");return t}async saveFinding(e){let t=await this.call("save_finding",{finding:e});if(!t.success)throw Error(t.error||"Failed to save finding")}async pickDocuments(){let e=await this.call("pick_documents");if(!e.success)throw Error(e.error||"Failed to pick documents");return e.files}async uploadFromPath(e,t,n){let a=await this.call("upload_from_path",{caseId:e,filePath:t,docType:n});if(!a.success||!a.data)throw Error(a.error||"Failed to upload document");return a.data}constructor(){this.invoke=null,this.initialized=!1}}let r=null;function c(){return r||(r=new s),r}async function o(e){return Array.from(new Uint8Array(await e.arrayBuffer()))}},3448:function(e,t,n){n.d(t,{cn:function(){return s},p6:function(){return r},sS:function(){return c}});var a=n(1994),i=n(3335);function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,i.m6)((0,a.W)(t))}function r(e,t){return("string"==typeof e?new Date(e):e).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric",...t})}function c(e){if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,t)).toFixed(1))," ").concat(["B","KB","MB","GB"][t])}}}]);