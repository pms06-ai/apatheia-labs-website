(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[479,519],{1804:function(e,t,a){Promise.resolve().then(a.bind(a,9729)),Promise.resolve().then(a.bind(a,9819)),Promise.resolve().then(a.bind(a,4717)),Promise.resolve().then(a.bind(a,3187))},9729:function(e,t,a){"use strict";a.d(t,{DocumentsList:function(){return h}});var r=a(7437),s=a(8736),n=a(2208),o=a(2735),c=a(7648),l=a(9820),i=a(9174),d=a(8210),u=a(3177);let m={police_bundle:"bg-status-critical/20 text-status-critical",social_work_assessment:"bg-status-high/20 text-status-high",expert_report:"bg-status-medium/20 text-status-medium",court_order:"bg-bronze-500/20 text-bronze-500",witness_statement:"bg-status-low/20 text-status-low",disclosure:"bg-charcoal-500/20 text-charcoal-300",other:"bg-charcoal-600/20 text-charcoal-400"};function h(){let{activeCase:e}=(0,u.Ur)(),t=(null==e?void 0:e.id)||"",{data:a,isLoading:h,error:p}=(0,d.sg)(t);return t?h?(0,r.jsx)("div",{className:"space-y-3",children:[1,2,3].map(e=>(0,r.jsx)("div",{className:"h-20 animate-pulse rounded-lg bg-charcoal-800/50 border border-charcoal-700/50"},e))}):p?(0,r.jsx)(l.Zb,{className:"p-8 text-center border-status-critical/30 bg-status-critical/5",children:(0,r.jsx)("p",{className:"text-status-critical font-medium",children:"Failed to retrieve document corpus"})}):a&&0!==a.length?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-between px-1",children:(0,r.jsxs)("h2",{className:"font-display text-sm text-charcoal-400 uppercase tracking-widest",children:["Corpus Inventory (",a.length,")"]})}),(0,r.jsx)("div",{className:"grid gap-3",children:a.map(e=>{var t;return(0,r.jsx)(c.default,{href:"/documents/".concat(e.id),className:"block group",children:(0,r.jsxs)(l.Zb,{className:"flex items-center gap-4 p-4 border-charcoal-700 bg-charcoal-800/40 hover:bg-charcoal-800/80 hover:border-bronze-500/50 hover:shadow-[0_0_15px_rgba(184,134,11,0.1)] transition-all duration-300",children:[(0,r.jsx)("div",{className:"h-12 w-12 rounded-lg bg-charcoal-900 flex items-center justify-center border border-charcoal-700 group-hover:border-bronze-500/30 transition-colors",children:(0,r.jsx)(s.Z,{className:"h-6 w-6 text-charcoal-400 group-hover:text-bronze-500 transition-colors"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"font-medium text-charcoal-100 truncate group-hover:text-white transition-colors",children:e.filename}),(0,r.jsx)(i.Ct,{variant:"outline",className:"border-0 uppercase tracking-wider font-bold text-[10px] px-1.5 py-0.5 ".concat(m[e.doc_type||"other"]||m.other),children:(e.doc_type||"other").replace(/_/g," ")})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-1.5 text-xs text-charcoal-500 font-mono",children:[(0,r.jsx)("span",{children:function(e){if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(1))+" "+["B","KB","MB","GB"][t]}(e.file_size||0)}),(0,r.jsx)("span",{className:"w-px h-3 bg-charcoal-700"}),e.page_count&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{children:[e.page_count," PAGES"]}),(0,r.jsx)("span",{className:"w-px h-3 bg-charcoal-700"})]}),(0,r.jsx)("span",{children:(t=e.created_at)?new Date(t).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"Unknown date"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity transform translate-x-2 group-hover:translate-x-0 duration-300",children:[(0,r.jsx)("div",{className:"p-2 rounded-lg bg-charcoal-900 border border-charcoal-700 text-bronze-500",children:(0,r.jsx)(n.Z,{className:"h-4 w-4"})}),(0,r.jsx)("div",{className:"p-2 rounded-lg bg-charcoal-900 border border-charcoal-700 text-charcoal-400 hover:text-white transition-colors",onClick:e=>{e.preventDefault()},children:(0,r.jsx)(o.Z,{className:"h-4 w-4"})})]})]})},e.id)})})]}):(0,r.jsxs)(l.Zb,{className:"p-12 text-center bg-charcoal-800/30 border-charcoal-700 border-dashed",children:[(0,r.jsx)(s.Z,{className:"h-12 w-12 mx-auto mb-4 text-charcoal-600"}),(0,r.jsx)("p",{className:"text-charcoal-400 font-medium",children:"No documents ingested"}),(0,r.jsx)("p",{className:"text-sm text-charcoal-500 mt-1",children:"Upload PDF or text files to begin the breakdown"})]}):(0,r.jsx)(l.Zb,{className:"p-12 text-center bg-charcoal-800/50 border-charcoal-700",children:(0,r.jsx)("p",{className:"text-charcoal-400 font-display",children:"Select a case to view document corpus"})})}},9819:function(e,t,a){"use strict";a.d(t,{DocumentUploader:function(){return y}});var r=a(7437),s=a(2265),n=a(5598),o=a(6475),c=a(7689),l=a(8736),i=a(1817),d=a(2489),u=a(9820),m=a(9174),h=a(8210),p=a(3177),x=a(3448),b=a(2243),f=a(6519),g=a(6175);let v={"application/pdf":[".pdf"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"text/plain":[".txt"],"text/markdown":[".md"],"application/json":[".json"],"text/csv":[".csv"],"text/html":[".html",".htm"],"audio/mpeg":[".mp3"],"audio/wav":[".wav"],"video/mp4":[".mp4"]},j=[{value:"court_order",label:"Court Order"},{value:"witness_statement",label:"Witness Statement"},{value:"expert_report",label:"Expert Report"},{value:"police_bundle",label:"Police Bundle"},{value:"social_work_assessment",label:"SW Assessment"},{value:"transcript",label:"Transcript"},{value:"correspondence",label:"Correspondence"},{value:"disclosure",label:"Disclosure"},{value:"threshold_document",label:"Threshold Document"},{value:"other",label:"Other"}];function y(){let[e,t]=(0,s.useState)([]),a=(0,p.Ur)(e=>e.activeCase),y=(0,b.nI)(),N=(0,h.TO)(),w=(0,h.XF)(),k=(0,s.useCallback)(e=>{let a=e.map(e=>({file:e,filename:e.name,size:e.size,docType:"other",status:"pending",progress:0}));t(e=>[...e,...a])},[]),{getRootProps:D,getInputProps:_,isDragActive:C}=(0,n.uI)({onDrop:k,accept:v,maxSize:52428800,disabled:y}),F=async()=>{try{let e=await (0,f.pickDocuments)();if(0===e.length)return;let a=e.map(e=>({path:e.path,filename:e.filename,docType:"other",status:"pending",progress:0}));t(e=>[...e,...a])}catch(e){g.ZP.error("Failed to open file picker"),console.error("File picker error:",e)}},z=(e,a)=>{t(t=>t.map((t,r)=>r===e?{...t,docType:a}:t))},I=e=>{t(t=>t.filter((t,a)=>a!==e))},P=async r=>{if(!a){g.ZP.error("No active case selected");return}let s=e[r];t(e=>e.map((e,t)=>t===r?{...e,status:"uploading",progress:30}:e));try{if(y&&s.path)await (0,f.uploadFromPath)(a.id,s.path,s.docType),t(e=>e.map((e,t)=>t===r?{...e,status:"completed",progress:100}:e));else if(s.file){let e=await N.mutateAsync({file:s.file,caseId:a.id,docType:s.docType});t(e=>e.map((e,t)=>t===r?{...e,status:"processing",progress:60}:e)),await w.mutateAsync(e.id),t(e=>e.map((e,t)=>t===r?{...e,status:"completed",progress:100}:e))}g.ZP.success("".concat(s.filename," uploaded and processed"))}catch(e){t(e=>e.map((e,t)=>t===r?{...e,status:"error",error:"Upload failed"}:e)),g.ZP.error("Failed to upload ".concat(s.filename)),console.error("Upload error:",e)}},E=async()=>{for(let t of e.map((e,t)=>"pending"===e.status?t:-1).filter(e=>-1!==e))await P(t)};return(0,r.jsxs)("div",{className:"space-y-4",children:[y?(0,r.jsxs)("div",{onClick:F,className:"cursor-pointer rounded-lg border-2 border-dashed border-charcoal-600 p-8 text-center transition hover:border-charcoal-500 hover:bg-charcoal-800/50",children:[(0,r.jsx)(o.Z,{className:"mx-auto h-10 w-10 text-charcoal-500"}),(0,r.jsx)("p",{className:"mt-4 text-sm text-charcoal-300",children:"Click to select documents"}),(0,r.jsx)("p",{className:"mt-1 text-xs text-charcoal-500",children:"PDF, DOCX, TXT, MD, JSON, CSV, HTML (max 50MB)"})]}):(0,r.jsxs)("div",{...D(),className:"cursor-pointer rounded-lg border-2 border-dashed p-8 text-center transition ".concat(C?"border-bronze-500 bg-bronze-500/10":"border-charcoal-600 hover:border-charcoal-500 hover:bg-charcoal-800/50"),children:[(0,r.jsx)("input",{..._()}),(0,r.jsx)(c.Z,{className:"mx-auto h-10 w-10 text-charcoal-500"}),(0,r.jsx)("p",{className:"mt-4 text-sm text-charcoal-300",children:C?"Drop files here...":"Drag & drop files here, or click to select"}),(0,r.jsx)("p",{className:"mt-1 text-xs text-charcoal-500",children:"PDF, DOCX, TXT, MP3, WAV, MP4 (max 50MB)"})]}),e.length>0&&(0,r.jsxs)(u.Zb,{className:"divide-y divide-charcoal-600/30",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3",children:[(0,r.jsxs)("h3",{className:"text-sm font-medium text-charcoal-100",children:["Upload Queue (",e.length," files)"]}),(0,r.jsx)("button",{onClick:E,disabled:!a||e.every(e=>"pending"!==e.status),className:"rounded-md bg-bronze-600 px-3 py-1.5 text-xs font-medium text-charcoal-900 transition hover:bg-bronze-500 disabled:opacity-50",children:"Upload All"})]}),e.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-4 px-4 py-3",children:[(0,r.jsx)(l.Z,{className:"h-8 w-8 text-charcoal-500"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"truncate text-sm text-charcoal-200",children:e.filename}),e.size&&(0,r.jsx)("span",{className:"text-xs text-charcoal-500",children:(0,x.sS)(e.size)})]}),"pending"!==e.status&&(0,r.jsx)("div",{className:"mt-2 h-1 overflow-hidden rounded-full bg-charcoal-700",children:(0,r.jsx)("div",{className:"h-full transition-all ".concat("completed"===e.status?"bg-status-success":"error"===e.status?"bg-status-critical":"bg-bronze-500"),style:{width:"".concat(e.progress,"%")}})})]}),"pending"===e.status&&(0,r.jsx)("select",{value:e.docType,onChange:e=>z(t,e.target.value),className:"rounded-md border border-charcoal-600 bg-charcoal-800 px-2 py-1 text-xs text-charcoal-200",children:j.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))}),"uploading"===e.status&&(0,r.jsx)(i.Z,{className:"h-4 w-4 animate-spin text-bronze-500"}),"processing"===e.status&&(0,r.jsx)(m.Ct,{variant:"info",children:"Processing"}),"completed"===e.status&&(0,r.jsx)(m.Ct,{variant:"success",children:"Done"}),"error"===e.status&&(0,r.jsx)(m.Ct,{variant:"critical",children:"Error"}),"pending"===e.status&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>P(t),disabled:!a,className:"rounded-md bg-bronze-600 px-2 py-1 text-xs font-medium text-charcoal-900 transition hover:bg-bronze-500 disabled:opacity-50",children:"Upload"}),(0,r.jsx)("button",{onClick:()=>I(t),className:"text-charcoal-500 hover:text-charcoal-300",children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})})]})]},t))]})]})}},6519:function(e,t,a){"use strict";a.r(t),a.d(t,{createCase:function(){return o},deleteCase:function(){return c},deleteDocument:function(){return m},getAnalysis:function(){return p},getCase:function(){return n},getCases:function(){return s},getDocument:function(){return i},getDocuments:function(){return l},getFindings:function(){return h},pickDocuments:function(){return f},runEngine:function(){return x},saveFinding:function(){return b},updateDocumentStatus:function(){return u},uploadDocument:function(){return d},uploadFromPath:function(){return g}});var r=a(2243);async function s(){return(0,r.nI)()?(0,r.vV)().getCases():(console.log("[Web Mode] getCases - would fetch from Supabase"),[])}async function n(e){return(0,r.nI)()?(0,r.vV)().getCase(e):(console.log("[Web Mode] getCase - would fetch from Supabase"),null)}async function o(e){if((0,r.nI)())return(0,r.vV)().createCase(e);throw Error("Web mode not implemented")}async function c(e){if((0,r.nI)())return(0,r.vV)().deleteCase(e);throw Error("Web mode not implemented")}async function l(e){return(0,r.nI)()?(0,r.vV)().getDocuments(e):(console.log("[Web Mode] getDocuments - would fetch from Supabase"),[])}async function i(e){return(0,r.nI)()?(0,r.vV)().getDocument(e):null}async function d(e,t,a){if(!(0,r.nI)())throw Error("Document upload only available in desktop mode");let s=await (0,r.tc)(t);return(0,r.vV)().uploadDocument({case_id:e,filename:t.name,file_type:t.type||"application/octet-stream",doc_type:a,data:s})}async function u(e,t,a){if(!(0,r.nI)())throw Error("Document update only available in desktop mode");return(0,r.vV)().updateDocumentStatus(e,t,a)}async function m(e){if((0,r.nI)())return(0,r.vV)().deleteDocument(e);throw Error("Web mode not implemented")}async function h(e){return(0,r.nI)()?(0,r.vV)().getFindings(e):(console.log("[Web Mode] getFindings - would fetch from Supabase"),[])}async function p(e){return(0,r.nI)()?(0,r.vV)().getAnalysis(e):{findings:[],contradictions:[],omissions:[]}}async function x(e){if(!(0,r.nI)())throw Error("Engine execution only available in desktop mode");return(0,r.vV)().runEngine(e)}async function b(e){if(!(0,r.nI)())throw Error("Saving findings only available in desktop mode");return(0,r.vV)().saveFinding(e)}async function f(){if(!(0,r.nI)())throw Error("File picker only available in desktop mode");return(0,r.vV)().pickDocuments()}async function g(e,t,a){if(!(0,r.nI)())throw Error("Upload from path only available in desktop mode");return(0,r.vV)().uploadFromPath(e,t,a)}}},function(e){e.O(0,[137,954,259,972,730,175,593,805,554,971,117,744],function(){return e(e.s=1804)}),_N_E=e.O()}]);